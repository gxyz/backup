author: me
title: NumPy学习-常用操作
date: 2017-09-03 15:40:13
tags:
    - python
    - numpy
---

## ndarray数组的变换

创建完成的数组，可以对其进行维度变换和元素类型变换。

常用方法:

|方法|说明|
|---|---|
|reshape(shape)|不改变数组元素，返回一个shape形状的数组，原数组不变|
|resize(shape)|与reshape功能一致，但修改原数组|
|swapaxes(ax1, ax2)|将数组n个维度中两个维度进行调换|
|flatten()|对数组进行降维，返回折叠后的一维数组，原数组不变|

- 这个的 shape 指的是数组的形状，也就是每一维的尺寸

例子:

```python
>>> import numpy as np
>>> arr1 = np.array([1,2,3,4,5,6,7,8])
>>> arr1.shape
(8,)
>>> arr2 = arr1.resize(2, 4)
>>> arr1.shape
(8,)
>>> arr2.shape
(2, 4)

>>> arr3 = np.array([1,2,3,4,5,6,7,8])
>>> arr3.shape
(8,)
>>> arr3.resize(2, 4)
>>> arr3.shape
(2, 4)

>>> arr4 = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
>>> arr4.shape
(3, 4)
>>> arr5 = arr4.swapaxes(0, 1)   # 这里相当于进行了转置
>>> arr4.shape
(3, 4)
>>> arr5.shape
(4, 3)
```

这里的 flatten 方法有一个参数，用来决定降维时的排列顺序, 最常用的是:

- 'C': 表示按行方向进行降维展开
- 'F': 表示按列方向进行降维展开

## ndarray数组的类型转换

在 numpy 中提供了很多可供我们选择的元素类型，如下所示:

|数据类型|说明|
|---|---|
|bool|布尔类型,True或False|
|intc|与C语言中的int类型一致，一般是int32或int64|
|intp|用于索引的整数，与C语言中的ssize_t一致，int32或int64|
|int8|字符长度的整数，取值[-128, 127]|
|int16|16位的整数，取值[-32768, 32767]|
|int32|32位的整数，取值[-2^31, 2^31-1]|
|int64|64位的整数，取值[-2^63, 2^63-1]|
|uint8|8位无符号的整数，取值[0, 255]|
|uint16|16位无符号的整数，取值[0, 65535]|
|uint32|32位无符号的整数，取值[0, 2^32-1]|
|uint64|64位无符号的整数，取值[0, 2^64-1]|
|float16|16位半精度浮点数：１位符号位，5位指数，10位尾数|
|float32|32位半精度浮点数：１位符号位，8位指数，32位尾数|
|float64|64位半精度浮点数：１位符号位，11位指数，52位尾数|
|complex64|复数类型，实部和虚部都是32位浮点数|
|complex128|复数类型，实部和虚部都是64位浮点数|

之所以细化为这么多中类型，就是为了能够让我们选择最适合的数据类型，来提高程序的效率。下面在来说说numpy的数组的数据类型转换，直接调用 数组对象的 `astype(new_type)` 方法:

- 这个方法的参数是转换的目标类型，即新类型
- 返回值是一个新的数组，即不会改变原数组

另外有一个 `tolist()` 方法，可以将数组转换为python的列表。

```python
>>> import numpy as np
>>> arr1 = np.array([1, 2, 3, 4, 5, 6, 7, 8], dtype=np.int32)
>>> arr2 = arr1.astype(np.float32)
>>> arr1
array([1, 2, 3, 4, 5, 6, 7, 8], dtype=int32)
>>> arr2
array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.], dtype=float32)

>>> arr1.tolist()
[1, 2, 3, 4, 5, 6, 7, 8]
```

## ndarray数组元素访问

对于 ndarray 数组中的元素，可以使用类型列表的索引和切片来进行访问，不过更加的灵活和强大，在 Python 内置的序列类型都是一维的，因此它们只支持一维切片，而 numpy 的数组类型支持多维切片，内部的实现方式其实就是让特殊方法`__getitem__()` 和 `__setitem__()` 以元组的形式，来接收多维切片的多个索引，具体的使用语法如下:


多维数组的元素的索引:

```python
>>> a = np.arange(24).reshape((2,3,4))
>>> a 
array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],
       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])
>>> a[1, 2, 3]    # 访问三维数组中的某个索引, 索引值也可以是负数
>>> 23
```

多维数组的切片:

```
a[start:end:step, start:end:step, start:end:step, ...]     # 同样使用逗号分割多个维度的切片操作，结果就是交集。
```

使用方式其实与一维的索引和切片是基本一致的

## ndarray数组的运算

> 数组与标量之间的运算 等同于 将数组的每一个元素与该标量进行计算之后的结果

对 ndarray中的数据执行元素级运算的函数：

**一元函数:**

|函数|说明|
|---|---|
|np.abs(x)  np.fabs(x)|计算数组中各元素的绝对值|
|np.sqrt(x)|计算数组各元素的平方根|
|np.square(x)|计算数组各元素的平方|
|np.log(x)/np.log10(x)/np.log2(x)|计算数组各元素的自然对数、10底对数和2底对数|
|np.ceil(x)/np.floor(x)|计算数组各元素的ceiling值和floor值|
|np.rint(x)|计算数组各元素的四舍五入值|
|np.modf(x)|将数组各元素的小数和整数部分以两个独立数组形式返回|
|np.cos(x) np.cosh(x) np.sin(x) np.sinh(x) np.tan(x) np.tanh(x)|计算数组各元素的普通型和双曲型三角函数|
|np.exp(x)|计算数组各元素的指数值|
|np.sign(x)|计算数组各元素符号函数值，1(+),0,-1(-)|

**二元函数:**

|函数|说明|
|---|---|
|+ - * / **|两个数组各元素进行对应运算|
|np.maximum(x,y)  np.fmax() np.minmum(x,y) np.fmin()|元素级的最大值/最小值计算|
|np.mod(x, y)|元素级的模运算|
|np.copysign(x,y)|将数组y中各元素值的符号赋值给数组x对应元素|
|> < >= <= == !=|算术比较，结果为布尔值|


另外还有一个常用的方法，就是计算一个数组中所有元素的平均值

```
a.mean()   # 获取数组a中的平均值
```

